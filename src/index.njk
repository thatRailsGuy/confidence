---
layout: base.njk
title: NFL Confidence Pool
description: Drag and drop your NFL picks in confidence order
---

<div class="min-h-screen flex flex-col items-center justify-center p-8 gap-8">
  <h1 class="text-2xl font-bold mb-4">
    ThatRailsGuy's NFL Confidence Order Drag and Drop Tool
  </h1>

  <div id="changes-indicator" class="hidden mb-4 px-4 py-2 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg flex items-center justify-between gap-4">
    <div class="flex items-center gap-2">
      <span>⚠️</span>
      <span>You have modified the default order or selections</span>
    </div>
    <button
      id="reset-btn"
      class="reset-btn px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors"
    >
      Reset to Defaults
    </button>
  </div>

  <p class="text-gray-500 text-sm mb-4 text-center max-w-2xl mx-auto">
    Select your pick for each matchup. Paste into or from Google Sheets or Excel.
    Odds and games are live if available, otherwise placeholders.
    <br>
    <span class="text-xs">Last updated: {{ nfl_odds.lastUpdated | dateFormat }}</span>
  </p>

  <div class="flex flex-wrap items-center gap-4 mb-6 justify-center">
    <div class="flex items-center gap-2">
      <label for="week-select" class="font-semibold">Week:</label>
      <select
        id="week-select"
        class="week-selector"
      >
        {% for week, games in nfl_odds.gamesByWeek %}
          {% if games.length > 0 %}
            <option value="{{ week }}" {% if week == (nfl_odds.currentWeek | string) %}selected{% endif %}>
              Week {{ week }}
            </option>
          {% endif %}
        {% endfor %}
      </select>
    </div>

    <button
      id="export-btn"
      class="export-btn px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
    >
      Export to Clipboard
    </button>
    <button
      id="import-btn"
      class="import-btn px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
    >
      Import from Clipboard
    </button>
  </div>

  {% set dataSource = nfl_odds %}
  {% set currentWeek = dataSource.currentWeek or 1 %}
  {% set currentWeekGames = dataSource.gamesByWeek[dataSource.currentWeek] or dataSource.games %}
  {% set sortedGames = currentWeekGames | sortByFavoriteOdds %}
  {% if sortedGames.length > 0 %}

  <table class="confidence-table min-w-[350px] border border-gray-300 rounded shadow bg-white">
    <thead>
      <tr class="bg-gray-100">
        <th class="p-2 text-gray-900 font-semibold">Confidence</th>
        <th class="p-2 text-gray-900 font-semibold">Away</th>
        <th class="p-2 text-gray-900 font-semibold">Home</th>
        <th class="p-2 text-gray-900 font-semibold">O/U</th>
        <th class="p-2 text-gray-900 font-semibold">Implied</th>
        <th class="p-2 text-gray-900 font-semibold">Info</th>
      </tr>
    </thead>
    <tbody id="games-tbody">
      {% for game in sortedGames %}
      {% set teams = game.matchup | split(' vs. ') %}
      {% set away = teams[0] %}
      {% set home = teams[1] %}
      {% set confidence = loop.length - loop.index0 %}
      {% set favorite = game | getFavorite %}

      <tr class="game-row bg-white hover:bg-gray-50 transition-colors" draggable="true" data-index="{{ loop.index0 }}">
        <td class="p-2 text-center font-bold text-gray-800 confidence-number">{{ confidence }}</td>

        <td class="p-2 cursor-pointer rounded team-cell {% if favorite == away %}selected{% endif %}" data-game-id="{{ game.id }}" data-team="{{ away }}">
          <div class="flex flex-col items-center">
            <span>{{ away }}</span>
            {% if game.odds and (game.odds | includes('/')) %}
              {% set oddsParts = game.odds | split('/') %}
              {% for part in oddsParts %}
                {% set cleanPart = part | trim %}
                {% if cleanPart | startsWith(away + ':') %}
                <span class="text-xs {% if favorite == away %}text-white{% else %}text-gray-600{% endif %}">{{ cleanPart | replace(away + ':', '') | trim }}</span>
                {% endif %}
              {% endfor %}
            {% endif %}
          </div>
        </td>

        <td class="p-2 cursor-pointer rounded team-cell {% if favorite == home %}selected{% endif %}" data-game-id="{{ game.id }}" data-team="{{ home }}">
          <div class="flex flex-col items-center">
            <span>{{ home }}</span>
            {% if game.odds and (game.odds | includes('/')) %}
              {% set oddsParts = game.odds | split('/') %}
              {% for part in oddsParts %}
                {% set cleanPart = part | trim %}
                {% if cleanPart | startsWith(home + ':') %}
                <span class="text-xs {% if favorite == home %}text-white{% else %}text-gray-600{% endif %}">{{ cleanPart | replace(home + ':', '') | trim }}</span>
                {% endif %}
              {% endfor %}
            {% endif %}
          </div>
        </td>

        <td class="p-2 text-center text-gray-800">
          {% if game.overUnder %}
            <span>{{ game.overUnder }}</span>
          {% else %}
            <span class="text-gray-400">—</span>
          {% endif %}
        </td>

        <td class="p-2 text-center text-gray-800">
          {% if game.impliedHome and game.impliedAway %}
            <span>
              <span class="text-xs text-gray-600">A:</span> {{ game.impliedAway }}
              <span class="text-xs text-gray-600">H:</span> {{ game.impliedHome }}
            </span>
          {% else %}
            <span class="text-gray-400">—</span>
          {% endif %}
        </td>

        <td class="p-2 text-gray-800">{{ game.info }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% else %}
  <div class="text-center p-8">
    <p class="text-gray-500 text-lg">No games available for the current week.</p>
    <p class="text-gray-400 text-sm mt-2">
      Last updated: {{ nfl_odds.lastUpdated | dateFormat }}
    </p>
  </div>
  {% endif %}

  <div class="flex flex-wrap items-center gap-4 mt-8 justify-center">
    <a
      href="https://football.fantasysports.yahoo.com/pickem"
      target="_blank"
      rel="noopener noreferrer"
      class="inline-block bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded transition-colors"
    >
      Yahoo Fantasy Football Pick'em
    </a>
    <a
      href="https://survivorgrid.com"
      target="_blank"
      rel="noopener noreferrer"
      class="inline-block bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition-colors"
    >
      SurvivorGrid
    </a>
  </div>

</div>

<!-- Embed NFL data for JavaScript -->
<script type="application/json" id="nfl-data">
{
  "games": {{ sortedGames | json | safe }},
  "gamesByWeek": {{ nfl_odds.gamesByWeek | json | safe }},
  "currentWeek": {{ nfl_odds.currentWeek or 1 }},
  "lastUpdated": "{{ nfl_odds.lastUpdated or '' }}"
}
</script>